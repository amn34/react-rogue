{"version":3,"sources":["InputManager.js","Entities/Entity.js","Entities/Player.js","Combat.js","World.js","Entities/Loot.js","Entities/Monster.js","Entities/Stairs.js","Entities/Shopkeeper.js","Entities/Spawner.js","ReactRouge.js","App.js","index.js"],"names":["InputManager","observers","handleKeys","e","preventDefault","keyCode","broadcast","x","y","fn","this","push","filter","subscriber","action","data","forEach","document","addEventListener","removeEventListener","Entity","size","attributes","verb","world","console","log","context","fillStyle","color","textBaseline","font","fillText","ascii","offset","Player","name","maxHealth","health","attack","defense","gold","dx","dy","item","power","Math","floor","random","level","addToHistory","newPlayer","Object","assign","Combat","attacker","defender","damage","type","reward","player","remove","World","width","height","tileSize","entities","history","worldmap","Array","entity","getEntityAtLocation","undefined","find","tempPlayer","copyPlayer","move","isWall","monster","tempMonster","copyMonster","vector","chooseMonsterDirection","rand","map","Map","Cellular","connected","randomize","userCallback","value","create","connect","drawWall","draw","fillRect","length","shift","Loot","add","Monster","newMonster","Stairs","createCellularMap","moveToSpace","spawner","Spawner","spawnLoot","spawnMonsters","spawnStairs","spawnShopKeeper","Shopkeeper","increase","getRandomInt","max","MonsterTable","lootTable","shopKeeper","spawnCount","createEntity","count","spawn","stairs","ReactRouge","canvasRef","React","useRef","useState","setWorld","inputManager","handleInput","newWorld","movePlayer","moveMonsters","useEffect","ctx","current","getContext","clearRect","bindKeys","subscribe","unbindKeys","unsubscribe","style","display","padding","index","key","ref","border","background","listStyle","App","className","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.922433d9.chunk.js","sourcesContent":["class InputManager {\r\n    observers = [];\r\n\r\n    subscribe(fn) {\r\n        this.observers.push(fn);\r\n    }\r\n\r\n    unsubscribe(fn) {\r\n        this.observers = this.observers.filter(subscriber => subscriber !== fn);\r\n    }\r\n\r\n    broadcast(action, data) {\r\n        this.observers.forEach(subscriber => subscriber(action, data));\r\n    }\r\n\r\n    handleKeys = e => {\r\n        e.preventDefault();\r\n        switch (e.keyCode) {\r\n            case 37: //left arrow\r\n                this.broadcast('move', {x:-1,y:0});\r\n                break;\r\n            case 38: //up arrow\r\n                this.broadcast('move', {x:0, y:-1});\r\n                break;\r\n            case 39: //right\r\n                this.broadcast('move', {x:1, y:0});\r\n                break;\r\n            case 40: //down\r\n                this.broadcast('move', {x:0, y:1});\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    bindKeys() {\r\n        document.addEventListener('keydown', this.handleKeys);\r\n    }\r\n\r\n    unbindKeys() {\r\n        document.removeEventListener('keydown', this.handleKeys);\r\n    }\r\n}\r\n\r\nexport default InputManager;","\r\nclass Entity {\r\n\r\n    constructor(x,y,size,attributes) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.size = size;\r\n        this.attributes = {...attributes};\r\n    }\r\n\r\n    action(verb, world) {\r\n        console.log(`Verb: ${verb}`);\r\n    }\r\n\r\n\r\n\r\n\r\n    draw(context) {\r\n        context.fillStyle = this.attributes.color || 'white';\r\n        context.textBaseline = 'hanging';\r\n        context.font = '16px Helvetica';\r\n        context.fillText(this.attributes.ascii,\r\n            this.x * this.size + (this.attributes.offset ? this.attributes.offset.x : 0),\r\n            this.y * this.size + (this.attributes.offset ? this.attributes.offset.y : 0)\r\n        );\r\n\r\n    }\r\n}\r\n\r\nexport default Entity;\r\n","import Entity from \"./Entity\";\r\n\r\nclass Player extends Entity{\r\n\r\n    attributes = {\r\n        name: 'Player',\r\n        ascii: '@',\r\n        maxHealth: 10,\r\n        health: 10,\r\n        attack: 1,\r\n        defense: 0,\r\n        gold: 0\r\n    }\r\n\r\n\r\n    action(verb, world) {\r\n        if(verb === \"bump\") {\r\n\r\n        }\r\n    }\r\n\r\n    move(dx, dy) {\r\n        //if the player is dead it can't move\r\n        if(this.attributes.health <= 0) return; \r\n\r\n        //otherwise move\r\n        this.x += dx;\r\n        this.y += dy;\r\n    }\r\n\r\n    add(item, world) {\r\n        \r\n        let power = 1 + Math.floor(Math.random() * 2);\r\n        if(item.attributes.name === 'Sword') {\r\n            this.attributes.attack = this.attributes.attack + power;\r\n        } else if(item.attributes.name === 'Armor') {\r\n            this.attributes.defense += power;\r\n        } else if(item.attributes.name === 'Gold') {\r\n            this.attributes.gold += power + Math.floor(Math.random() * world.level);\r\n        } else {\r\n            //potion, heals and adds +1 maxhealth\r\n            power += 4 + world.level;\r\n            this.attributes.health += power;\r\n            this.attributes.maxHealth += 1;\r\n            //prevents the player from having more health than max health\r\n            if(this.attributes.health > this.attributes.maxHealth) {\r\n                this.attributes.health = this.attributes.maxHealth;\r\n            }\r\n        }\r\n\r\n        world.addToHistory(`You have picked up ${item.attributes.name}`);\r\n        world.addToHistory(`Power: ${power}`);\r\n    }\r\n\r\n\r\n    copyPlayer() {\r\n        let newPlayer = new Player();\r\n        Object.assign(newPlayer, this);\r\n        return newPlayer;\r\n    }\r\n}\r\nexport default Player;","class Combat {\r\n\r\n    static attack(attacker, defender, world) {\r\n        \r\n        let damage = attacker.attributes.attack - defender.attributes.defense;\r\n        if(damage > 0) {\r\n            defender.attributes.health -= damage;\r\n            world.addToHistory(`${attacker.attributes.name} attacks ${defender.attributes.name} for ${damage} damage`);\r\n            if(defender.attributes.health <= 0) {\r\n                world.addToHistory(`${defender.attributes.name} has died!`)\r\n                if(defender.attributes.type === 'monster') { \r\n                    world.addToHistory(`You collected ${defender.attributes.reward} gold`);\r\n                    world.player.attributes.gold += defender.attributes.reward;\r\n                    world.remove(defender);\r\n                }\r\n            }\r\n        } else {\r\n            world.addToHistory(`${attacker.attributes.name} dealt no damage to ${defender.attributes.name}`);\r\n        }\r\n    }\r\n\r\n    \r\n\r\n}\r\n\r\nexport default Combat","import { Map } from 'rot-js';\r\nimport Player from './Entities/Player';\r\nimport Combat from './Combat';\r\n\r\nclass World {\r\n\r\n    constructor(width, height, tileSize) {\r\n        this.width = width;\r\n        this.height = height;\r\n        this.tileSize = tileSize;\r\n        this.entities = [new Player(0,0,16)];\r\n        this.level = 0;\r\n        this.history = [];\r\n\r\n\r\n        this.worldmap = new Array(this.width);\r\n        for (let x = 0; x< this.width; x++) {\r\n            this.worldmap[x] = new Array(this.height);\r\n        }\r\n    }\r\n\r\n    get player() {\r\n        return this.entities[0];\r\n    }\r\n\r\n    add(entity) {\r\n        this.entities.push(entity);\r\n    }\r\n\r\n    remove(entity) {\r\n        this.entities = this.entities.filter(e => e !== entity);\r\n    }\r\n\r\n    //if the entity is spawned in the wall move it until it reaches a \r\n    //free space \r\n    moveToSpace(entity) {\r\n        for(let x = entity.x; x < this.width; x++) {\r\n            for(let y = entity.y; y < this.height; y++) {\r\n                if(this.worldmap[x][y] === 0 && !this.getEntityAtLocation(x,y)) {\r\n                    entity.x = x;\r\n                    entity.y = y;\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    //returns if the square the player is moving to is a invalid square\r\n    isWall(x, y) {\r\n        return (this.worldmap[x] === undefined ||\r\n             this.worldmap[y] === undefined ||\r\n             this.worldmap[x][y] === 1);\r\n    } \r\n\r\n    getEntityAtLocation(x,y) {\r\n        return this.entities.find(entity => entity.x === x && entity.y === y);\r\n    }\r\n\r\n    movePlayer(dx, dy) {\r\n        let tempPlayer = this.player.copyPlayer();\r\n        tempPlayer.move(dx,dy);\r\n        let entity = this.getEntityAtLocation(tempPlayer.x, tempPlayer.y);\r\n        if(entity) { //if there is another entity then interact with it\r\n            entity.action('bump', this);\r\n            return;\r\n        }\r\n        if (!this.isWall(tempPlayer.x, tempPlayer.y)) { //if free space then move player\r\n            this.player.move(dx,dy);\r\n        }\r\n    }\r\n\r\n    moveMonsters(world) {\r\n        this.entities.filter(entity => entity.attributes.type === 'monster').forEach(monster => {\r\n            let tempMonster = monster.copyMonster();\r\n            let vector = this.chooseMonsterDirection();\r\n            let dx = vector.x;\r\n            let dy = vector.y;\r\n            tempMonster.move(dx,dy);\r\n            let entity = this.getEntityAtLocation(tempMonster.x, tempMonster.y);\r\n            if(entity === this.player) {\r\n                Combat.attack(tempMonster, this.player, world);\r\n                return;\r\n            } else if (entity) {\r\n                return;\r\n            }\r\n            if(!this.isWall(tempMonster.x, tempMonster.y)) {\r\n                monster.move(dx,dy)\r\n            }\r\n        });\r\n    }\r\n\r\n    chooseMonsterDirection() {\r\n        let rand = Math.floor(Math.random() * 4) + 1;\r\n        if(rand === 1) return {x:1,y:0};\r\n        if(rand === 2) return {x:-1,y:0};\r\n        if(rand === 3) return {x:0,y:1};\r\n        if(rand === 4) return {x:0,y:-1};\r\n    }\r\n\r\n\r\n    createCellularMap() {\r\n        var map = new Map.Cellular(this.width, this.height, { connected:true });\r\n        map.randomize(0.5);\r\n        var userCallback = (x, y, value) => {\r\n            if(x === 0 || y === 0 || x === this.width - 1 || y === this.height - 1) {\r\n                this.worldmap[x][y] = 1; //create walls around the edges of the map\r\n                return;\r\n            }\r\n            this.worldmap[x][y] = value === 0 ? 1: 0;\r\n        };\r\n        map.create(userCallback);\r\n        map.connect(userCallback, 1);\r\n    }\r\n\r\n    draw(context) {\r\n        //draws the map\r\n        for(let x = 0; x < this.width; x++) {\r\n            for(let y = 0; y < this.height; y++) {\r\n                if(this.worldmap[x][y] === 1) this.drawWall(context, x, y);\r\n            }\r\n        }\r\n\r\n        //draws the entities in the game\r\n        this.entities.forEach(entity => {\r\n            entity.draw(context);\r\n        }); \r\n\r\n    }\r\n\r\n    drawWall(context, x, y) {\r\n        context.fillStyle = '#000';\r\n        context.fillRect(x * this.tileSize, y * this.tileSize,\r\n             this.tileSize, this.tileSize);\r\n    }\r\n\r\n    addToHistory(history) {\r\n        this.history.push(history);\r\n        //keeps the history from getting to long\r\n        if(this.history.length > 6) this.history.shift();\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default World;","import Entity from \"./Entity\";\r\n\r\nclass Loot extends Entity {\r\n\r\n    action(verb, world) {\r\n        if(verb === 'bump') {\r\n            console.log('Pickup', this);\r\n            world.player.add(this, world);\r\n            world.remove(this);\r\n        }\r\n        if(verb === 'drop') {\r\n            console.log('drop', this);\r\n        }\r\n    }\r\n}\r\n\r\nexport default Loot;","import Entity from \"./Entity.js\";\r\nimport Combat from \"../Combat.js\";\r\n\r\nclass Monster extends Entity {\r\n    action(verb, world) {\r\n        if(verb === 'bump') {\r\n            //attack \r\n            Combat.attack(world.player, this, world);\r\n            if(this.attributes.health > 0) { //monster lives and counterattacks\r\n                Combat.attack(this, world.player, world);\r\n            }\r\n        }\r\n    }\r\n\r\n    move(dx, dy) {\r\n        this.x += dx;\r\n        this.y += dy;\r\n    }\r\n\r\n    copyMonster() {\r\n        let newMonster = new Monster();\r\n        Object.assign(newMonster, this);\r\n        return newMonster;\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default Monster;\r\n","import Entity from \"./Entity\";\r\nimport Spawner from \"./Spawner\";\r\n\r\n\r\nclass Stairs extends Entity {\r\n\r\n    attributes = {\r\n        name: 'Stair',\r\n        color: 'white',\r\n         ascii: '>',\r\n         offset: { x: 2, y: 2 }\r\n    };\r\n\r\n    action(verb, world) {\r\n        if(verb === 'bump') {\r\n            //moves down to the next floor\r\n            world.level += 1;\r\n            world.addToHistory('You move down the stairs...');\r\n            world.addToHistory(`You have entered B${world.level}`);\r\n            world.createCellularMap();\r\n            world.player.x = 0;\r\n            world.player.y = 0;\r\n            world.moveToSpace(world.player);\r\n            //clears out the previous map\r\n            world.entities = world.entities.filter(e => e === world.player);\r\n            let spawner = new Spawner(world);\r\n            spawner.spawnLoot(10);\r\n            spawner.spawnMonsters(6);\r\n            spawner.spawnStairs();\r\n            spawner.spawnShopKeeper();\r\n        }\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\nexport default Stairs;","import Entity from \"./Entity\";\r\n\r\nclass Shopkeeper extends Entity{\r\n    \r\n    action(verb, world) {\r\n        if(verb === 'bump') {\r\n            let rand = Math.floor(Math.random() * 3);\r\n            let increase  = Math.floor(world.player.attributes.gold / 4);\r\n            if(rand === 0) {\r\n                world.addToHistory(`You purchased ${increase} swords from Shopkeeper Kevin`);\r\n                world.player.attributes.attack += increase;\r\n            } else if(rand === 1) {\r\n                world.addToHistory(`You purchased ${increase} armor from Shopkeeper Omri`);\r\n                world.player.attributes.defense += increase;\r\n            } else {\r\n                world.addToHistory(`Shopkeeper Joey stole all your gold!`);\r\n            }\r\n            world.player.attributes.gold = 0;\r\n            world.remove(this);\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport default Shopkeeper;","import Loot from \"./Loot\";\r\nimport Monster from \"./Monster\";\r\nimport Stairs from \"./Stairs\";\r\nimport Shopkeeper from \"./Shopkeeper\";\r\n\r\n\r\n\r\n\r\nclass Spawner {\r\n    \r\n    constructor(world) {\r\n        this.world = world;\r\n        this.MonsterTable = [\r\n            {type: 'monster', name: 'Ogre', color: 'lightgrey', ascii: 'O', offset: {x: 2, y: 3}, \r\n                health: 5 + (world.level * 4), attack: 2 + (world.level * 4),\r\n                defense: 0 + (world.level * 2), reward: 3 + (world.level)},\r\n\r\n            {type: 'monster', name: 'Snake', color: 'lightgreen', ascii: 'S', offset: {x: 2, y: 3}, \r\n                health: 3 + (world.level * 4), attack: 2 + (world.level * 4), \r\n                defense: 0 + (world.level * 2), reward: 2 + (world.level)},\r\n\r\n            {type: 'monster', name: 'Rat', color: 'darkgrey', ascii: 'R', offset: {x: 2, y: 3}, \r\n                health: 2 + (world.level * 4), attack: 1 + (world.level * 4), \r\n                defense: 0 + (world.level * 2), reward: 1 + (world.level)},\r\n\r\n            {type: 'monster', name: 'Penguin', color: 'blue', ascii: 'P', offset: {x: 2, y: 3}, \r\n                health: 10 + (world.level * 4), attack: 3 + (world.level * 4), \r\n                defense: 0 + (world.level * 2), reward: 6 + (world.level)},\r\n        ];\r\n        \r\n        this.lootTable = [\r\n            {type: 'item', name: 'Sword', color: 'darkgrey', ascii: '/', offset: {x: 6, y: 3}},\r\n            {type: 'item', name: 'Potion', color: 'red', ascii: '!', offset: {x: 6, y: 3}},\r\n            {type: 'item', name: 'Gold', color: 'yellow', ascii: '$', offset: {x: 3, y: 3}},\r\n            {type: 'item', name: 'Armor', color: 'lightgrey', ascii: '#', offset: {x: 4, y: 3}}  \r\n        ];\r\n\r\n        this.shopKeeper = {type: 'shopkeeper', ascii: 'Q', offset: {x:2, y:3}};\r\n    }\r\n\r\n    spawn(spawnCount, createEntity) {\r\n        for(let count = 0; count < spawnCount; count++) {\r\n            let entity = createEntity();\r\n            this.world.add(entity);\r\n            this.world.moveToSpace(entity);\r\n        }\r\n    };\r\n\r\n    spawnLoot(spawnCount) {\r\n        this.spawn(spawnCount, () => {\r\n            return new Loot(\r\n                getRandomInt(this.world.width - 1),\r\n                getRandomInt(this.world.height - 1),\r\n                this.world.tileSize,\r\n                this.lootTable[getRandomInt(this.lootTable.length)]);\r\n        });\r\n    }\r\n\r\n    spawnMonsters(spawnCount) {\r\n        this.spawn(spawnCount, () => {\r\n            return new Monster(\r\n                getRandomInt(this.world.width - 1),\r\n                getRandomInt(this.world.height - 1),\r\n                this.world.tileSize,\r\n                this.MonsterTable[getRandomInt(this.lootTable.length)]);\r\n        });\r\n    }\r\n\r\n    spawnShopKeeper() {\r\n        this.spawn(1, () => {\r\n            return new Shopkeeper(\r\n                getRandomInt(this.world.width - 1),\r\n                getRandomInt(this.world.height - 1),\r\n                this.world.tileSize,\r\n                this.shopKeeper);\r\n        });\r\n    }\r\n\r\n    spawnStairs() {\r\n        let stairs = new Stairs(this.world.width - 10,\r\n             this.world.height - 10, this.world.tileSize);\r\n        this.world.add(stairs);\r\n        this.world.moveToSpace(stairs);\r\n    }\r\n\r\n\r\n}\r\n\r\nfunction getRandomInt(max) {\r\n    return Math.floor(Math.random() * Math.floor(max));\r\n}\r\n\r\nexport default Spawner;\r\n","import React,{useEffect, useState} from 'react';\r\nimport InputManager from './InputManager.js';\r\nimport World from './World.js';\r\nimport Spawner  from './Entities/Spawner.js';\r\n\r\nconst ReactRouge  = ({width, height, tileSize}) => { \r\n\r\n\r\n    const canvasRef = React.useRef(null);\r\n    //update the world \r\n    const[world, setWorld] = useState(new World(width, height, tileSize)); \r\n    //handles user input\r\n    let inputManager = new InputManager();\r\n\r\n    //action for user input\r\n    const handleInput = (action, data) => {\r\n        let newWorld = new World();\r\n        Object.assign(newWorld, world); //deep copy?\r\n        newWorld.movePlayer(data.x, data.y);\r\n        newWorld.moveMonsters(world);\r\n        setWorld(newWorld);\r\n    };\r\n\r\n    //creates the map\r\n    useEffect(() => {\r\n        let newWorld = new World();\r\n        Object.assign(newWorld, world);\r\n        newWorld.createCellularMap();\r\n        newWorld.moveToSpace(world.player); //moves the player to a open space\r\n        let spawner = new Spawner(newWorld);\r\n        spawner.spawnLoot(10);\r\n        spawner.spawnMonsters(6);\r\n        spawner.spawnStairs();\r\n        setWorld(newWorld);\r\n        //eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []); //prevents createmap from being called after every movement\r\n\r\n    //draws the map\r\n    useEffect(() => {\r\n        const ctx  = canvasRef.current.getContext('2d');\r\n        ctx.clearRect(0,0,width * tileSize, height * tileSize);\r\n        world.draw(ctx, tileSize);\r\n    });\r\n\r\n    //adds key listener\r\n    useEffect(() => {\r\n        inputManager.bindKeys();\r\n        inputManager.subscribe(handleInput);\r\n        return () =>  {\r\n            inputManager.unbindKeys();\r\n            inputManager.unsubscribe(handleInput);\r\n        };\r\n    });\r\n\r\n    return (         \r\n    <div style = {{display: 'flex'}}>\r\n        <ul style = {{padding: '20px'}}>\r\n            <li style = {{display: 'inline-center'}}> Log: </li>\r\n            <li> -------------------------------</li>\r\n            {world.history.map((item, index) => (<li key = {index}>{item}</li>))} \r\n        </ul>\r\n        <canvas \r\n            ref = {canvasRef}\r\n            width = {width * tileSize}  \r\n            height = {height * tileSize}\r\n            style = {{border: '1px solid black', background: 'DimGray', display: 'block'}}\r\n        ></canvas> \r\n        <ul style = {{listStyle: 'none'}}>\r\n            <h1> B{world.level}</h1>\r\n            <li> Health: {world.player.attributes.health} / {world.player.attributes.maxHealth}</li>\r\n            <li> Attack: {world.player.attributes.attack}</li>\r\n            <li> Defense: {world.player.attributes.defense}</li>\r\n            <li> Gold: {world.player.attributes.gold}</li>\r\n        </ul>\r\n    </div>\r\n)};\r\n\r\nexport default ReactRouge;","import React from 'react';\r\nimport ReactRouge from './ReactRouge.js';\r\n\r\n//function that returns jsx\r\nconst App = () => (\r\n<div className=\"App\"> \r\n  {/* Passing props into the react component*/}\r\n  <ReactRouge width = {40} height = {40} tileSize = {16}/>\r\n</div>\r\n);\r\n\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n"],"sourceRoot":""}