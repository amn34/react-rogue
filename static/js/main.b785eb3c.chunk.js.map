{"version":3,"sources":["InputManager.js","Entity.js","Player.js","World.js","Loot.js","Monster.js","Stairs.js","Shopkeeper.js","Spawner.js","ReactRouge.js","App.js","index.js"],"names":["InputManager","observers","handleKeys","e","preventDefault","keyCode","broadcast","x","y","fn","this","push","filter","subscriber","action","data","forEach","document","addEventListener","removeEventListener","Entity","size","attributes","verb","world","console","log","context","fillStyle","color","textBaseline","font","fillText","ascii","offset","Player","name","maxHealth","health","attack","defense","gold","dx","dy","item","power","Math","floor","random","addToHistory","newPlayer","Object","assign","World","width","height","tileSize","entities","level","history","worldmap","Array","entity","getEntityAtLocation","undefined","find","tempPlayer","player","copyPlayer","move","isWall","type","monster","tempMonster","copyMonster","vector","chooseMonsterDirection","attackPlayer","rand","map","Map","Cellular","connected","randomize","userCallback","value","create","connect","drawWall","draw","fillRect","length","shift","Loot","add","remove","Monster","damage","newMonster","Stairs","createCellularMap","moveToSpace","spawner","Spawner","MonsterTable","reward","spawnLoot","spawnMonsters","spawnStairs","spawnShopKeeper","Shopkeeper","num","getRandomInt","max","lootTable","shopTable","spawnCount","createEntity","count","spawn","stairs","ReactRouge","canvasRef","React","useRef","useState","setWorld","inputManager","handleInput","JSON","stringify","newWorld","movePlayer","moveMonsters","useEffect","bindKeys","subscribe","unbindKeys","unsubscribe","ctx","current","getContext","clearRect","style","display","padding","index","key","ref","border","background","listStyle","App","className","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.b785eb3c.chunk.js","sourcesContent":["class InputManager {\r\n    observers = [];\r\n\r\n    subscribe(fn) {\r\n        this.observers.push(fn);\r\n    }\r\n\r\n    unsubscribe(fn) {\r\n        this.observers = this.observers.filter(subscriber => subscriber !== fn);\r\n    }\r\n\r\n    broadcast(action, data) {\r\n        this.observers.forEach(subscriber => subscriber(action, data));\r\n    }\r\n\r\n    handleKeys = e => {\r\n        e.preventDefault();\r\n        switch (e.keyCode) {\r\n            case 37: //left arrow\r\n                this.broadcast('move', {x:-1,y:0});\r\n                break;\r\n            case 38: //up arrow\r\n                this.broadcast('move', {x:0, y:-1});\r\n                break;\r\n            case 39: //right\r\n                this.broadcast('move', {x:1, y:0});\r\n                break;\r\n            case 40: //down\r\n                this.broadcast('move', {x:0, y:1});\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    bindKeys() {\r\n        document.addEventListener('keydown', this.handleKeys);\r\n    }\r\n\r\n    unbindKeys() {\r\n        document.removeEventListener('keydown', this.handleKeys);\r\n    }\r\n}\r\n\r\nexport default InputManager;","class Entity {\r\n\r\n    constructor(x,y,size,attributes) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.size = size;\r\n        this.attributes = {...attributes};\r\n    }\r\n\r\n    action(verb, world) {\r\n        console.log(`Verb: ${verb}`);\r\n    }\r\n\r\n\r\n\r\n\r\n    draw(context) {\r\n        context.fillStyle = this.attributes.color || 'white';\r\n        context.textBaseline = 'hanging';\r\n        context.font = '16px Helvetica';\r\n        context.fillText(this.attributes.ascii,\r\n            this.x * this.size + (this.attributes.offset ? this.attributes.offset.x : 0),\r\n            this.y * this.size + (this.attributes.offset ? this.attributes.offset.y : 0)\r\n        );\r\n    }\r\n}\r\n\r\nexport default Entity;\r\n","import Entity from \"./Entity\";\r\n\r\nclass Player extends Entity{\r\n\r\n    attributes = {\r\n        name: 'Player',\r\n        ascii: '@',\r\n        maxHealth: 10,\r\n        health: 10,\r\n        attack: 1,\r\n        defense: 0,\r\n        gold: 0\r\n    }\r\n\r\n    move(dx, dy) {\r\n        //if the player is dead it can't move\r\n        if(this.attributes.health <= 0) return; \r\n\r\n        //otherwise move\r\n        this.x += dx;\r\n        this.y += dy;\r\n    }\r\n\r\n    add(item, world) {\r\n        \r\n        let power = 1 + Math.floor(Math.random() * 2);\r\n        if(item.attributes.name === 'Sword') {\r\n            this.attributes.attack = this.attributes.attack + power;\r\n        } else if(item.attributes.name === 'Armor') {\r\n            this.attributes.defense += power;\r\n        } else if(item.attributes.name === 'Gold') {\r\n            this.attributes.gold += power;\r\n        } else {\r\n            //potion, heals and adds +1 maxhealth\r\n            power += 4\r\n            this.attributes.health += power;\r\n            this.attributes.maxHealth += 1;\r\n            //prevents the player from having more health than max health\r\n            if(this.attributes.health > this.attributes.maxHealth) {\r\n                this.attributes.health = this.attributes.maxHealth;\r\n            }\r\n        }\r\n\r\n        world.addToHistory(`You have picked up ${item.attributes.name}`);\r\n        world.addToHistory(`Power: ${power}`);\r\n    }\r\n\r\n\r\n    copyPlayer() {\r\n        let newPlayer = new Player();\r\n        Object.assign(newPlayer, this);\r\n        return newPlayer;\r\n    }\r\n}\r\nexport default Player;","import { Map } from 'rot-js';\r\nimport Player from './Player';\r\n\r\nclass World {\r\n\r\n    constructor(width, height, tileSize) {\r\n        this.width = width;\r\n        this.height = height;\r\n        this.tileSize = tileSize;\r\n        this.entities = [new Player(0,0,16)];\r\n        this.level = 0;\r\n        this.history = [];\r\n\r\n\r\n        this.worldmap = new Array(this.width);\r\n        for (let x = 0; x< this.width; x++) {\r\n            this.worldmap[x] = new Array(this.height);\r\n        }\r\n    }\r\n\r\n    get player() {\r\n        return this.entities[0];\r\n    }\r\n\r\n    add(entity) {\r\n        this.entities.push(entity);\r\n    }\r\n\r\n    remove(entity) {\r\n        this.entities = this.entities.filter(e => e !== entity);\r\n    }\r\n\r\n    //if the entity is spawned in the wall move it until it reaches a \r\n    //free space \r\n    moveToSpace(entity) {\r\n        for(let x = entity.x; x < this.width; x++) {\r\n            for(let y = entity.y; y < this.height; y++) {\r\n                if(this.worldmap[x][y] === 0 && !this.getEntityAtLocation(x,y)) {\r\n                    entity.x = x;\r\n                    entity.y = y;\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    //returns if the square the player is moving to is a invalid square\r\n    isWall(x, y) {\r\n        return (this.worldmap[x] === undefined ||\r\n             this.worldmap[y] === undefined ||\r\n             this.worldmap[x][y] === 1);\r\n    } \r\n\r\n    getEntityAtLocation(x,y) {\r\n        return this.entities.find(entity => entity.x === x && entity.y === y);\r\n    }\r\n\r\n    movePlayer(dx, dy) {\r\n        let tempPlayer = this.player.copyPlayer();\r\n        tempPlayer.move(dx,dy);\r\n        let entity = this.getEntityAtLocation(tempPlayer.x, tempPlayer.y);\r\n        if(entity) {\r\n            console.log(entity);\r\n            entity.action('bump', this);\r\n            return;\r\n        }\r\n        if (this.isWall(tempPlayer.x, tempPlayer.y)) {\r\n            console.log(`Way blocked at ${tempPlayer.x}:${tempPlayer.y}!`);\r\n        } else {\r\n            this.player.move(dx,dy);\r\n        }\r\n    }\r\n\r\n    moveMonsters(world) {\r\n        this.entities.filter(entity => entity.attributes.type === 'monster').forEach(monster => {\r\n            let tempMonster = monster.copyMonster();\r\n            let vector = this.chooseMonsterDirection();\r\n            let dx = vector.x;\r\n            let dy = vector.y;\r\n            tempMonster.move(dx,dy);\r\n            console.log('move monster');\r\n            let entity = this.getEntityAtLocation(tempMonster.x, tempMonster.y);\r\n            if(entity === this.player) {\r\n                monster.attackPlayer(world);\r\n                return;\r\n            } else if(entity) {\r\n                return;\r\n            }\r\n            if(!this.isWall(tempMonster.x, tempMonster.y)) {\r\n                monster.move(dx,dy)\r\n            }\r\n        });\r\n    }\r\n\r\n    chooseMonsterDirection() {\r\n        let rand = Math.floor(Math.random() * 4) + 1;\r\n        if(rand === 1) return {x:1,y:0};\r\n        if(rand === 2) return {x:-1,y:0};\r\n        if(rand === 3) return {x:0,y:1};\r\n        if(rand === 4) return {x:0,y:-1};\r\n    }\r\n\r\n\r\n    createCellularMap() {\r\n        let map = new Map.Cellular(this.width, this.height, {connected:true});\r\n        map.randomize(0.5);\r\n        let userCallback = (x,y,value) => {\r\n            if(x === 0 || y === 0 || x === this.width -1 || y === this.height - 1) {\r\n                this.worldmap[x][y] = 1;\r\n                return;\r\n            }\r\n            this.worldmap[x][y] = (value === 0) ? 1: 0;\r\n        };\r\n        map.create(userCallback);\r\n        //1 is the empty spaces\r\n        map.connect(userCallback, 1);\r\n    }\r\n\r\n    draw(context) {\r\n        //draws the map\r\n        for(let x = 0; x < this.width; x++) {\r\n            for(let y = 0; y < this.height; y++) {\r\n                if(this.worldmap[x][y] === 1) this.drawWall(context, x, y);\r\n            }\r\n        }\r\n\r\n        //draws the entities in the game\r\n        this.entities.forEach(entity => {\r\n            entity.draw(context);\r\n        }); \r\n\r\n    }\r\n\r\n    drawWall(context, x, y) {\r\n        context.fillStyle = '#000';\r\n        context.fillRect(x * this.tileSize, y * this.tileSize,\r\n             this.tileSize, this.tileSize);\r\n    }\r\n\r\n    addToHistory(history) {\r\n        this.history.push(history);\r\n        //keeps the history from getting to long\r\n        if(this.history.length > 6) this.history.shift();\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default World;","import Entity from \"./Entity\";\r\n\r\nclass Loot extends Entity {\r\n\r\n    action(verb, world) {\r\n        if(verb === 'bump') {\r\n            console.log('Pickup', this);\r\n            world.player.add(this, world);\r\n            world.remove(this);\r\n        }\r\n        if(verb === 'drop') {\r\n            console.log('drop', this);\r\n        }\r\n    }\r\n}\r\n\r\nexport default Loot;","import Entity from \"./Entity\";\r\n\r\nclass Monster extends Entity {\r\n    action(verb, world) {\r\n        if(verb === 'bump') {\r\n            //attack \r\n            let damage = world.player.attributes.attack - this.attributes.defense;\r\n            if(damage > 0) {\r\n                this.attributes.health -= damage;\r\n                world.addToHistory(`Player attacks ${this.attributes.name} for ${damage} damage!`);\r\n            } else {\r\n                world.addToHistory(`You dealt no damage to ${this.attributes.name}`);\r\n            }\r\n            if(this.attributes.health <= 0) { //monster dies\r\n                world.addToHistory(`${this.attributes.name} dies!`);\r\n                world.addToHistory('You collected 1 gold');\r\n                world.player.attributes.gold += 1;\r\n                world.remove(this);\r\n            } else { //monster lives and counterattacks\r\n                world.addToHistory(`${this.attributes.name}'s has ${this.attributes.health} health`);\r\n                this.attackPlayer(world);\r\n                if(world.player.attributes.health <= 0) {\r\n                    world.addToHistory(`You have died!`); \r\n                } \r\n            }\r\n        }\r\n    }\r\n\r\n    attackPlayer(world) {\r\n        let damage = this.attributes.attack - world.player.attributes.defense;\r\n        if(damage > 0) {\r\n            world.player.attributes.health -= damage;\r\n            world.addToHistory(`You were attacked by ${this.attributes.name} for ${damage} damage`);\r\n            world.addToHistory(`You have ${world.player.attributes.health} health left`);\r\n        } else {\r\n            world.addToHistory('The monster did no damage');\r\n        }\r\n    }\r\n\r\n    move(dx, dy) {\r\n        this.x += dx;\r\n        this.y += dy;\r\n    }\r\n\r\n    copyMonster() {\r\n        let newMonster = new Monster();\r\n        Object.assign(newMonster, this);\r\n        return newMonster;\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default Monster;\r\n","import Entity from \"./Entity\";\r\nimport Spawner from \"./Spawner\";\r\n\r\n\r\nclass Stairs extends Entity {\r\n\r\n    attributes = {\r\n        name: 'Stair',\r\n        color: 'white',\r\n         ascii: '>',\r\n         offset: { x: 2, y: 2 }\r\n    };\r\n\r\n    action(verb, world) {\r\n        if(verb === 'bump') {\r\n            world.level += 1;\r\n            world.addToHistory('You move down the stairs...');\r\n            world.addToHistory(`You have entered B${world.level}`);\r\n            world.createCellularMap();\r\n            world.player.x = 0;\r\n            world.player.y = 0;\r\n            world.moveToSpace(world.player);\r\n            world.entities = world.entities.filter(e => e === world.player);\r\n            let spawner = new Spawner(world);\r\n            //improves the stats of each monster in the game. \r\n            spawner.MonsterTable.forEach(monster => {\r\n                monster.health += 5 * world.level;\r\n                monster.attack += 5 * world.level;\r\n                monster.defense += 2 * world.level;\r\n                monster.reward += 1 * world.level;\r\n            });\r\n\r\n            spawner.spawnLoot(10);\r\n            spawner.spawnMonsters(6);\r\n            spawner.spawnStairs();\r\n            spawner.spawnShopKeeper();\r\n        }\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\nexport default Stairs;","import Entity from \"./Entity\";\r\n\r\nclass Shopkeeper extends Entity{\r\n    \r\n    action(verb, world) {\r\n        if(verb === 'bump') {\r\n            let rand = this.attributes.num;\r\n            if(rand === 0) {\r\n                world.addToHistory(`You purchased ${world.player.attributes.gold} swords from Shopkeeper Kevin`);\r\n                world.player.attributes.attack += world.player.attributes.gold;\r\n                world.player.attributes.gold = 0;\r\n            } else if(rand === 1) {\r\n                world.addToHistory(`You purchased ${world.player.attributes.gold} armor from Shopkeeper Omri`);\r\n                world.player.attributes.defense += world.player.attributes.gold;\r\n                world.player.attributes.gold = 0;\r\n            } else {\r\n                world.addToHistory(`Shopkeeper Joey stole all your gold!`);\r\n                world.player.attributes.gold = 0;\r\n            }\r\n            world.remove(this);\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport default Shopkeeper;","import Loot from \"./Loot\";\r\nimport Monster from \"./Monster\";\r\nimport Stairs from \"./Stairs\";\r\nimport Shopkeeper from \"./Shopkeeper\";\r\n\r\n\r\n\r\n\r\nclass Spawner {\r\n    \r\n    constructor(world) {\r\n        this.world = world;\r\n        this.MonsterTable = [\r\n            {type: 'monster', name: 'Ogre', color: 'lightgrey', ascii: 'O', offset: {x: 2, y: 3}, health: 5, attack: 2, defense: 0, reward: 3},\r\n            {type: 'monster', name: 'Snake', color: 'lightgreen', ascii: 'S', offset: {x: 2, y: 3}, health: 3, attack: 2, defense: 0, reward: 2},\r\n            {type: 'monster', name: 'Rat', color: 'darkgrey', ascii: 'R', offset: {x: 2, y: 3}, health: 2, attack: 1, defense: 0, reward: 1},\r\n            {type: 'monster', name: 'Penguin', color: 'blue', ascii: 'P', offset: {x: 2, y: 3}, health: 10, attack: 3, defense: 0, reward: 6},\r\n        ];\r\n        \r\n        this.lootTable = [\r\n            {type: 'item', name: 'Sword', color: 'darkgrey', ascii: '/', offset: {x: 6, y: 3}},\r\n            {type: 'item', name: 'Potion', color: 'red', ascii: '!', offset: {x: 6, y: 3}},\r\n            {type: 'item', name: 'Gold', color: 'yellow', ascii: '$', offset: {x: 3, y: 3}},\r\n            {type: 'item', name: 'Armor', color: 'lightgrey', ascii: '#', offset: {x: 4, y: 3}}  \r\n        ];\r\n\r\n        this.shopTable = [\r\n            {type: 'shopkeeper', name: 'Kevin', ascii: 'Q', offset: {x:2, y:3}, num: 0},\r\n            {type: 'shopkeeper', name: 'Omri', ascii: 'Q', offset: {x:2, y:3}, num: 1},\r\n            {type: 'shopkeeper', name: 'Joey', ascii: 'Q', offset: {x:2, y:3}, num: 2},\r\n        ];\r\n    }\r\n\r\n    spawn(spawnCount, createEntity) {\r\n        for(let count = 0; count < spawnCount; count++) {\r\n            let entity = createEntity();\r\n            this.world.add(entity);\r\n            this.world.moveToSpace(entity);\r\n        }\r\n    };\r\n\r\n    spawnLoot(spawnCount) {\r\n        this.spawn(spawnCount, () => {\r\n            return new Loot(\r\n                getRandomInt(this.world.width - 1),\r\n                getRandomInt(this.world.height - 1),\r\n                this.world.tileSize,\r\n                this.lootTable[getRandomInt(this.lootTable.length)]);\r\n        });\r\n    }\r\n\r\n    spawnMonsters(spawnCount) {\r\n        this.spawn(spawnCount, () => {\r\n            return new Monster(\r\n                getRandomInt(this.world.width - 1),\r\n                getRandomInt(this.world.height - 1),\r\n                this.world.tileSize,\r\n                this.MonsterTable[getRandomInt(this.lootTable.length)]);\r\n        });\r\n    }\r\n\r\n    spawnShopKeeper() {\r\n        this.spawn(1, () => {\r\n            return new Shopkeeper(\r\n                getRandomInt(this.world.width - 1),\r\n                getRandomInt(this.world.height - 1),\r\n                this.world.tileSize,\r\n                this.shopTable[getRandomInt(this.shopTable.length)]);\r\n        });\r\n    }\r\n\r\n    spawnStairs() {\r\n        let stairs = new Stairs(this.world.width - 10,\r\n             this.world.height - 10, this.world.tileSize);\r\n        this.world.add(stairs);\r\n        this.world.moveToSpace(stairs);\r\n    }\r\n\r\n\r\n}\r\n\r\nfunction getRandomInt(max) {\r\n    return Math.floor(Math.random() * Math.floor(max));\r\n}\r\n\r\nexport default Spawner;\r\n","import React,{useEffect, useState} from 'react';\r\nimport InputManager from './InputManager.js';\r\nimport World from './World.js';\r\nimport Spawner  from './Spawner.js';\r\n\r\nconst ReactRouge  = ({width, height, tileSize}) => { \r\n    const canvasRef = React.useRef(null);\r\n    const[world, setWorld] = useState(new World(width, height, tileSize)); \r\n    let inputManager = new InputManager();\r\n\r\n    const handleInput = (action, data) => {\r\n        console.log(`handle input: ${action}:${JSON.stringify(data)}`);\r\n        let newWorld = new World();\r\n        Object.assign(newWorld, world); //deep copy?\r\n        newWorld.movePlayer(data.x, data.y);\r\n        newWorld.moveMonsters(world);\r\n        setWorld(newWorld);\r\n    };\r\n\r\n    useEffect(() => {\r\n        console.log('Create map');\r\n        let newWorld = new World();\r\n        Object.assign(newWorld, world);\r\n        newWorld.createCellularMap();\r\n        newWorld.moveToSpace(world.player); //moves the player to a valid space\r\n        let spawner = new Spawner(newWorld);\r\n        spawner.spawnLoot(10);\r\n        spawner.spawnMonsters(6);\r\n        spawner.spawnStairs();\r\n        setWorld(newWorld);\r\n        //eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []); //prevents createmap from being called after every movement\r\n\r\n    useEffect(() => {\r\n        console.log('Bind input manager');\r\n        inputManager.bindKeys();\r\n        inputManager.subscribe(handleInput);\r\n        return () =>  {\r\n            inputManager.unbindKeys();\r\n            inputManager.unsubscribe(handleInput);\r\n        };\r\n    });\r\n\r\n    useEffect(() => {\r\n        console.log(\"Draw to the canvas\");\r\n        const ctx  = canvasRef.current.getContext('2d');\r\n        ctx.clearRect(0,0,width * tileSize, height * tileSize);\r\n        world.draw(ctx, tileSize);\r\n    });\r\n\r\n\r\n    return (         \r\n    <div style = {{display: 'flex'}}>\r\n        <ul style = {{padding: '20px'}}>\r\n            <li style = {{display: 'inline-center'}}> Log: </li>\r\n            <li> -------------------------------</li>\r\n            {world.history.map((item, index) => (<li key = {index}>{item}</li>))} \r\n        </ul>\r\n        <canvas \r\n            ref = {canvasRef}\r\n            width = {width * tileSize}  \r\n            height = {height * tileSize}\r\n            style = {{border: '1px solid black', background: 'DimGray', display: 'block'}}\r\n        ></canvas> \r\n        <ul style = {{listStyle: 'none'}}>\r\n            <h1> B{world.level}</h1>\r\n            <li> Health: {world.player.attributes.health} / {world.player.attributes.maxHealth}</li>\r\n            <li> Attack: {world.player.attributes.attack}</li>\r\n            <li> Defense: {world.player.attributes.defense}</li>\r\n            <li> Gold: {world.player.attributes.gold}</li>\r\n        </ul>\r\n    </div>\r\n)};\r\n\r\nexport default ReactRouge;","import React from 'react';\r\nimport ReactRouge from './ReactRouge.js';\r\n\r\n//function that returns jsx\r\nconst App = () => (\r\n<div className=\"App\"> \r\n  {/* Passing props into the react component*/}\r\n  <ReactRouge width = {40} height = {40} tileSize = {16}/>\r\n</div>\r\n);\r\n\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n"],"sourceRoot":""}